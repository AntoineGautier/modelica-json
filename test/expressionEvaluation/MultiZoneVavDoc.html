<html><head><title>MultiZoneVavDoc</title></head><body><h1><a name="1freeze-protection-sequence-fo"></a><!--[if !supportLists]--><span style="mso-list:Ignore">1.&nbsp;</span><!--[endif]-->Freeze protection sequence for multizone air handling unit</h1>
<p>
Freeze protection sequence for multizone AHU system. It is developed based on Section
5.16.12 of ASHRAE Guideline 36, May 2020.
</p>
<ol>
<li>
If the supply air temperature <code>TAirSup</code> drops below 4.4 °C (40 °F)
for 5 minutes, send two (or more, as required to ensure that heating plant is active,
<code>minHotWatReq</code>&nbsp;(2, adjustable)) heating hot-water plant requests, override the outdoor
air damper to the minimum position, and modulate the heating coil to maintain a suppy
air temperature of at least 6 °C (42 °F).
Disable this function when supply air temperature rises above 7 °C (45 °F) for
5 minutes.
</li>
<li>
If the supply air temperature <code>TAirSup</code> drops below 3.3 °C (38 °F)
for 5 minutes, fully close both the economizer damper and the minimum outdoor air
damper for 1 hour and set a Level 3 alarm noting that minimum ventilation was
interrupted. After 1 hour, the unit shall resume minimum outdoor air ventilation
and enter the previous stage of freeze protection.
<ul>
<li>
If it is warm enough that the supply air temperature rises above 7 °C (45 °F)
with minimum ventilation, the unit will remain in Stage 1 freeze protection for 5
minutes then resume normal operation.
</li>
</ul>
</li>
<li>
Upon signal from the freeze-stat (if installed),
or if supply air temperature drops below 3.3 °C (38 °F) for 15 minutes or
below 1 °C (34 °F) for 5 minutes, shut down supply and return (or relief)
fan(s), close outdoor air damper, open the cooling-coil valve to 100%, and energize
the CHW pump system. Also send two (or more, as required to ensure that heating plant
is active, <code>minHotWatReq</code>&nbsp;(2, adjustable)) heating hot-water plant requests,
modulate the heating coil to maintain the higher of the supply air temperature or
the mixed air temperature at 27 °C (80 °F), and set a Level 2 alarm indicating
the unit is shut down by freeze protection.
<ul>
<li>
If a freeze-protection shutdown is triggered by a low air temperature sensor reading,
it shall remain in effect until it is reset by a software switch from the operator's
workstation. (If a freeze-stat with a physical reset switch is used instead, there
shall be no software reset switch.)
</li>
</ul>
</li>
</ol><h1><a name="2output-plant-requests-for-mul"></a><!--[if !supportLists]--><span style="mso-list:Ignore">2.&nbsp;</span><!--[endif]-->Output plant requests for multizone air handling unit</h1>
<p>
This sequence outputs the system reset requests for multiple zone air handling unit. The
implementation is according to the Section 5.16.16 of ASHRAE Guideline 36, May 2020. 
</p>
<h2><a name="2.1chilled-water-reset-request"></a><!--[if !supportLists]--><span style="mso-list:Ignore">2.1.&nbsp;</span><!--[endif]-->Chilled water reset request yChiWatResReq</h2>

<ol>
<li>
If the supply air temperature <code>TAirSup</code> exceeds the supply air temperature
set point <code>TAirSupSet</code> by 3 °C (5 °F) for 2 minutes, send 3 requests.
</li>
<li>
If the supply air temperature <code>TAirSup</code> exceeds the supply air temperature
set point <code>TAirSupSet</code> by 2 °C (3 °F) for 2 minutes, send 2 requests.
</li>
<li>
Else if the chilled water valve position <code>uCooCoiSet</code> is greater than
95%, send 1 request until the <code>uCooCoiSet</code> is less than 85%.
</li>
<li>
Else if the chilled water valve position <code>uCooCoiSet</code> is less than 95%,
send 0 request.
</li>
</ol>
<h2><a name="2.2chiller-plant-request-ychip"></a><!--[if !supportLists]--><span style="mso-list:Ignore">2.2.&nbsp;</span><!--[endif]-->Chiller plant request yChiPlaReq</h2>

<p>
Send the chiller plant that serves the system a chiller plant request as follows:
</p>
<ol>
<li>
If the chilled water valve position <code>uCooCoiSet</code> is greater than
95%, send 1 request until the <code>uCooCoiSet</code> is less than 10%.
</li>
<li>
Else if the chilled water valve position <code>uCooCoiSet</code> is less than 95%,
send 0 request.
</li>
</ol>
<h2><a name="2.3if-there-is-a-hot-water-coi"></a><!--[if !supportLists]--><span style="mso-list:Ignore">2.3.&nbsp;</span><!--[endif]-->If there is a hot-water coil, hot-water
reset requests yHotWatResReq</h2>

<ol>
<li>
If the supply air temperature <code>TAirSup</code> is 17 °C (30 °F) less than
the supply air temperature set point <code>TAirSupSet</code> for 5 minutes, send 3
requests.
</li>
<li>
Else if the supply air temperature <code>TAirSup</code> is 8 °C (15 °F) less than
the supply air temperature set point <code>TAirSupSet</code> for 5 minutes, send 2
requests.
</li>
<li>
Else if the hot water valve position <code>uHeaCoiSet</code> is greater than
95%, send 1 request until the <code>uHeaCoiSet</code> is less than 85%.
</li>
<li>
Else if the hot water valve position <code>uHeaCoiSet</code> is less than 95%,
send 0 request.
</li>
</ol>
<h2><a name="2.4if-there-is-a-hot-water-coi"></a><!--[if !supportLists]--><span style="mso-list:Ignore">2.4.&nbsp;</span><!--[endif]-->If there is a hot-water coil and heating hot-water plant, heating hot-water
plant reqeusts yHotWatPlaReq</h2>

<p>
Send the heating hot-water plant that serves the air handling unit a heating hot-water
plant request as follows:
</p>
<ol>
<li>
If the hot water valve position <code>uHeaCoiSet</code> is greater than 95%, send 1
request until the hot water valve position is less than 10%.
</li>
<li>
If the hot water valve position <code>uHeaCoiSet</code> is less than 95%, send 0 requests.
</li>
</ol><h1><a name="3outdoor-air-and-return-air-da"></a><!--[if !supportLists]--><span style="mso-list:Ignore">3.&nbsp;</span><!--[endif]-->Outdoor air and return air damper position limits for units with separated minimum outdoor air damper and airflow measurement</h1>
<p>
Block that outputs the position limits of the return and outdoor air damper for units
with a separated minimum outdoor air damper and airflow measurement.
It is implemented according to Section 5.16.5 of the ASHRAE Guideline 36, May 2020.
</p>
<h2><a name="3.1minimum-outdoor-air-set-poi"></a><!--[if !supportLists]--><span style="mso-list:Ignore">3.1.&nbsp;</span><!--[endif]-->Minimum outdoor air set point</h2>

<p>
Calculate the outdoor air set point with
<span style="color: grey;" id="Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.SetPoints.OutdoorAirFlow"><a>
Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.SetPoints.OutdoorAirFlow</a></span>.
</p>
<h2><a name="3.2minimum-outdoor-air-control"></a><!--[if !supportLists]--><span style="mso-list:Ignore">3.2.&nbsp;</span><!--[endif]-->Minimum outdoor air control loop</h2>

<p>
Minimum outdoor air control loop is enabled when the supply fan is proven ON
(<code>u1SupFan=true</code>) and in occupied mode, and disabled and output set to
zero otherwise
</p>
<p>
The minimum outdoor airflow rate shall be maintained at the minimum outdoor air
set point by a reverse-acting control loop whose output is 0% to 100%.
From 0% to 50% loop output, the minimum outdoor air damper is opened from 0%
(<code>minOutDamPhy_min</code>&nbsp;(0, adjustable)) to 100% (<code>minOutDamPhy_max</code>&nbsp;(1, adjustable)).
</p>
<h2><a name="3.3return-air-damper"></a><!--[if !supportLists]--><span style="mso-list:Ignore">3.3.&nbsp;</span><!--[endif]-->Return air damper</h2>

<ul>
<li>
Return air damper minimum outdoor air control is enabled when the minimum outdoor
air damper is fully open and the economizer outdoor air damper is less than a projected
position limit, which is 5% when supply fan speed is at 100% design speed proportionally
up to 80% when the fan is at minimum speed.
</li>
<li>
Return air damper minimum outdoor air control is disabled when the minimum outdoor
air damper is not fully open or the economizer outdoor air damper is 10% above the projected
position limit as determined above.
</li>
<li>
When enabled, the maximum return air damper set point is reduced from 100%
(<code>retDamPhy_max</code>&nbsp;(1, adjustable)) to 0% (<code>retDamPhy_min</code>&nbsp;(0, adjustable))
as the minimum outdoor air loop output rises from 50% to 100%.
</li>
</ul><h1><a name="4outdoor-air-and-return-air-da"></a><!--[if !supportLists]--><span style="mso-list:Ignore">4.&nbsp;</span><!--[endif]-->Outdoor air and return air damper position limits for units with separated minimum outdoor air damper and differential pressure control</h1>
<p>
Block that outputs the position limits of the return and outdoor air damper for units
with a separated minimum outdoor air damper and differential pressure control.
It is implemented according to Section 5.16.4 of the ASHRAE Guideline 36, May 2020.
</p>
<h2><a name="4.1differential-pressure-setpo"></a><!--[if !supportLists]--><span style="mso-list:Ignore">4.1.&nbsp;</span><!--[endif]-->Differential pressure setpoint across the minimum outdoor air damper</h2>

<ul>
<li>
Per Section 3.2.1, designer should provide the design minimum pressure difference across
the minimum outdoor air damper, <code>dpDesMinOutDam</code>&nbsp;(20&nbsp;Pa, adjustable). The absolute minimum
pressure difference (<code>dpAbsMinOutDam</code>&nbsp;(5&nbsp;Pa, adjustable)) should also be provided if complying
with California Title 24 requirements.
</li>
<li>
Calculate the outdoor air set point with
<a href="#16outdoor-airflow-related-calc" style="white-space: nowrap;">Section 16</a>
if complying with ASHRAE 62.1 requirements. Otherwise, see the set points in
<a href="#20ahu-level-setpoint-calculati" style="white-space: nowrap;">Section 20</a>
if complying with Title 24 requirements.
</li>
<li>
The minimum outdoor air differential pressure set point shall be calculated per
Section 5.16.4.1 (if complying with ASHRAE 62.1 requirements) or Section 5.16.4.2
(if complying with Title 24 requirements).
</li>
</ul>
<h2><a name="4.2open-minimum-outdoor-air-da"></a><!--[if !supportLists]--><span style="mso-list:Ignore">4.2.&nbsp;</span><!--[endif]-->Open minimum outdoor air damper</h2>

<p>
Open minimum outdoor air damper when the supply air fan is proven ON and the system
is in occupied mode and the minimum differential pressure set point is greater
than zero. Damper shall be closed otherwise.
</p>
<h2><a name="4.3return-air-damper"></a><!--[if !supportLists]--><span style="mso-list:Ignore">4.3.&nbsp;</span><!--[endif]-->Return air damper</h2>

<ul>
<li>
Return air damper minimum outdoor air control is enabled when the minimum outdoor
air damper is open and the economizer outdoor air damper is less than a projected
position limit, which is 5% when supply fan speed is at 100% design speed proportionally
up to 80% when the fan is at minimum speed.
</li>
<li>
Return air damper minimum outdoor air control is disabled when the minimum outdoor
air damper is closed or the economizer outdoor air damper is 10% above the projected
position limit as determined above.
</li>
<li>
When enabled, the maximum return air damper set point is modulated from 100% to 0%
to maintain the differential pressure across the minimum outdoor air damper at set
point.
</li>
</ul><h1><a name="5outdoor-air-and-return-air-da"></a><!--[if !supportLists]--><span style="mso-list:Ignore">5.&nbsp;</span><!--[endif]-->Outdoor air and return air damper position limits for units with common damper</h1>
<p>
This block models the multi zone VAV AHU minimum outdoor air control with a single
common damper for minimum outdoor air and economizer functions based on outdoor airflow
measurement, designed in line with the Section 5.16.6 of the ASHRAE Guideline 36, May 2020.
</p>
<p>
The controller is enabled when the supply fan is proven on (<code>u1SupFan=true</code>) and
the AHU operation mode <span style="color: grey;" id="Buildings.Controls.OBC.ASHRAE.G36.Types.OperationModes"><a>
Buildings.Controls.OBC.ASHRAE.G36.Types.OperationModes</a></span> equals <code>occupied</code>.
Otherwise the damper position limits are set to their corresponding maximum and minimum physical or at
commissioning fixed limits. The state machine chart below illustrates listed conditions:
</p>
<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" damper="" position="" limits="" state="" machine="" chart\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_Economizers_Subsequences_Limits_StateMachineChart.png">
</p>
<p>
The controller sets the outdoor and return damper position limits so
that the outdoor airflow rate <code>VOut_flow</code> stays equal or above the
minimum outdoor air setpoint <code>VOutMinSet_flow</code>. The fraction of the controller
output signal between <code>yMin</code>&nbsp;(0, adjustable) and <code>uRetDam_min</code>&nbsp;(0.5, adjustable) is
linearly mapped to the outdoor air damper minimal position <code>yOutDam_min</code>
while the fraction of the controller output between <code>uRetDam_min</code>&nbsp;(0.5, adjustable) and
<code>yMax</code>&nbsp;(1, adjustable) is linearly mapped to the return air damper maximum position
<code>yRetDam_max</code>. Thus the dampers are not interlocked.
</p>
<p>
The following control charts show the input/output structure and an expected damper position
limits for a well configured controller.
</p>
<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" damper="" position="" limits="" control="" diagram\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_Economizers_Subsequences_Limits_ControlDiagram.png">
</p>
<p>
The expected damper position limits vs. the control loop signal are as follows:
</p>
<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" damper="" position="" limits="" control="" chart\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_Economizers_Subsequences_Limits_ControlChart.png">
</p><h1><a name="6multi-zone-vav-ahu-economizer"></a><!--[if !supportLists]--><span style="mso-list:Ignore">6.&nbsp;</span><!--[endif]-->Multi zone VAV AHU economizer enable/disable switch</h1>
<p>
This is a multi zone VAV AHU economizer enable/disable sequence
based on the Section 5.16.7 of the ASHRAE Guideline 36, May 2020. Additional
conditions included in the sequence are: freeze protection (freeze protection
stage 0-3, see Section 5.16.12), supply fan status (on or off, see Section 5.16.5).
</p>
<p>
The economizer is disabled whenever the outdoor air conditions
exceed the economizer high limit setpoint.
This sequence allows for all device types listed in
ASHRAE 90.1-2013 and Title 24-2013.
</p>
<p>
In addition, the economizer gets disabled without a delay whenever any of the
following is <code>true</code>:
</p>
<ul>
<li>
The supply fan is off (<code>u1SupFan = false</code>),
</li>
<li>
the freeze protection stage
<span style="color: grey;" id="Buildings.Controls.OBC.ASHRAE.G36.Types.FreezeProtectionStages"><a>
Buildings.Controls.OBC.ASHRAE.G36.Types.FreezeProtectionStages</a></span>
is not <code>stage0</code>.
</li>
</ul>
<p>
The following state machine chart illustrates the transitions between enabling and disabling:
</p>
<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" economizer="" enable-disable="" state="" machine="" chart\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_Economizers_Subsequences_EconEnableDisableStateMachineChart.png">
</p>
<p>
After the disable signal is activated, the following procedure is applied, in order to
prevent pressure fluctuations in the HVAC system:
</p>
<ul>
<li>
The return damper gets fully opened (<code>yRetDam_max = uRetDamPhy_max</code> and
<code>yRetDam_min = uRetDamPhy_max</code>) for <code>retDamFulOpeTim</code>&nbsp;(180&nbsp;s, adjustable)
time period, after which the return damper gets released to its minimum outdoor airflow control position
(<code>yRetDam_max = uRetDam_max</code> and <code>yRetDam_min = uRetDam_max</code>).
</li>
<li>
The outdoor air damper is closed to its minimum outoor airflow control limit (<code>yOutDam_max = uOutDam_min</code>)
after a <code>disDel</code>&nbsp;(15&nbsp;s, adjustable) time delay.
</li>
</ul><h1><a name="7modulates-dampers-of-economiz"></a><!--[if !supportLists]--><span style="mso-list:Ignore">7.&nbsp;</span><!--[endif]-->Modulates dampers of economizer in buildings using return fan to control the pressure</h1>
<p>
Block modulates the damper of economizers of buildings with pressure controlled by
return fan and airflow tracking. It is implemented according to Section 5.16.2.3.d,
Figure 5.16.2.3-2 and Figure 5.16.2.3-3 of ASHRAE Guideline 36, May 2020.
</p>
<p>
Return air damper position limits, which are the inputs to the sequence, are the outputs of
sequences in package
<span style="color: grey;" id="Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.Economizers.Subsequences.Limits"><a>
Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.Economizers.Subsequences.Limits</a></span>.
It also requires input <code>uTSup</code> from
<a href="#13multizone-vav-ahu-supply-air" style="white-space: nowrap;">Section 13</a>
sequences.
</p>
<p>
The time rate of change of the damper signals is limited by a first order hold,
using the sample time <code>samplePeriod</code>.
This prevents a quick opening of the outdoor air damper, for example when the
outdoor airflow setpoint has a step change.
Slowing down the opening of the outdoor air damper allows the freeze protection
to componensate with its dynamics that is faster than the opening of the outdoor air damper.
To avoid that all dampers are closed, the return air damper has the same
time rate of change limitation.
</p>
<p>
The modulation is shown as the control chart:
<br>
</p>
<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" the="" damper="" modulation="" for="" economizer="" in="" buildings="" with="" pressure="" controller="" by="" return="" fan\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_Economizers_Subsequences_Modulations_ReturnFan.png">
</p>
<p>
Note in the above chart, if the building has direct pressure control
(<code>have_dirCon</code>), the profile for relief air damper control should
be ignored.
</p><h1><a name="8modulates-dampers-of-economiz"></a><!--[if !supportLists]--><span style="mso-list:Ignore">8.&nbsp;</span><!--[endif]-->Modulates dampers of economizer in buildings using relief damper or fan to control the pressure</h1>
<p>
This is a multi zone VAV AHU economizer modulation block. It calculates
the outdoor and return air damper positions based on the supply air temperature
control loop signal. It is implemented according to Section 5.16.2.3.d,
Figure 5.16.2.3-1 of ASHRAE Guideline 36, May 2020.
Damper positions are linearly mapped to
the supply air control loop signal.
</p>
<p>
When the economizer is enabled, the PI controller modulates the damper
positions. Return and outdoor damper are not interlocked. When the economizer is disabled,
the damper positions are set to the minimum outdoor air damper position limits.
</p>
<p>
The control charts below show the input-output structure and an economizer damper
modulation sequence assuming a well configured controller. Control diagram:
</p>
<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" the="" multi="" zone="" ahu="" modulation="" sequence="" control="" diagram\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_Economizers_Subsequences_Modulations_ReliefControlDiagram.png">
</p>
<p>
Multi zone AHU economizer modulation control chart:
<br>
</p>
<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" the="" multi="" zone="" ahu="" modulation="" sequence="" expected="" performance\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_Economizers_Subsequences_Modulations_ReliefControlChart.png">
</p><h1><a name="9specify-the-economizer-high-l"></a><!--[if !supportLists]--><span style="mso-list:Ignore">9.&nbsp;</span><!--[endif]-->Specify the economizer high liimits</h1>
<p>
This block outputs the air economizer high limits according to the energy standard,
device type and climate zone. The implementation is according to the Section 5.1.17 of ASHRAE
Guideline 36, May 2020.
</p>
<p>When ASHRAE 90.1-2016 is used.</p>
<table summary="\&quot;summary\&quot;" border="\&quot;1\&quot;">
<tbody><tr><th>Device type</th> <th>Allowed only in these ASHRAE Climate Zones</th><th>Required High Limit (Economizer OFF when)</th></tr>
<tr>
<td rowspan="\&quot;3\&quot;">Fixed dry bulb</td><td>1b, 2b, 3b, 3c, 4b, 4c, 5b, 5c, 6b, 7, 8</td>
<td>outdoor air temperature is higher than 24 °C (<code>TCut=24°C</code>)</td>
</tr>
<tr>
<td>5a, 6a</td><td>outdoor air temperature is higher than 21 °C (<code>TCut=21°C</code>)</td>
</tr>
<tr>
<td>1a, 2a, 3a, 4a</td><td>outdoor air temperature is higher than 18 °C (<code>TCut=18°C</code>)</td>
</tr>
<tr>
<td>Differential dry bulb</td><td>1b, 2b, 3b, 3c, 4b, 4c, 5a, 5b, 5c, 6a, 6b, 7, 8</td>
<td>outdoor air temperature is higher than the return air temperature (<code>TCut=TRet</code>)</td>
</tr>
<tr>
<td>Fixed enthalpy with fixed dry bulb</td><td>All</td>
<td>outdoor air temperature is higher than 24 °C or the enthalpy is higher than 66 kJ/kg (<code>TCut=24°C</code> or <code>hCut=66kJ/kg</code>)</td>
</tr>
<tr>
<td>Differential enthalpy with fixed dry bulb</td><td>All</td>
<td>outdoor air temperature is higher than 24 °C or the outdoor air enthalpy is higher than the return air enthalpy (<code>TCut=24°C</code> or <code>hCut=hRet</code>)</td>
</tr>
<tr>
<td rowspan="\&quot;2\&quot;">Fixed dry bulb with differential dry bulb</td>
<td>1b, 2b, 3b, 3c, 4b, 4c, 5b, 5c, 6b, 7, 8</td>
<td>outdoor air temperature is higher than 24 °C or the return air temperature (<code>TCut=min(24°C, TRet)</code>)</td>
</tr>
<tr>
<td>5a, 6a</td>
<td>outdoor air temperature is higher than 21 °C or the return air temperature (<code>TCut=min(21°C, TRet)</code>)</td>
</tr>
</tbody></table>
<p>When California Title 24-2016 is used.</p>
<table summary="\&quot;summary\&quot;" border="\&quot;1\&quot;">
<tbody><tr><th>Device type</th> <th>California Climate Zones</th><th>Required High Limit (Economizer OFF when)</th></tr>
<tr>
<td rowspan="\&quot;4\&quot;">Fixed dry bulb</td><td>1, 3, 5, 11 to 16</td><td>outdoor air temperature is higher than 24 °C (<code>TCut=24°C</code>)</td>
</tr>
<tr>
<td>2, 4, 10</td><td>outdoor air temperature is higher than 23 °C (<code>TCut=23°C</code>)</td>
</tr>
<tr>
<td>6, 8, 9</td><td>outdoor air temperature is higher than 22 °C (<code>TCut=22°C</code>)</td>
</tr>
<tr>
<td>7</td><td>outdoor air temperature is higher than 21 °C (<code>TCut=21°C</code>)</td>
</tr>
<tr>
<td rowspan="\&quot;4\&quot;">Differential dry bulb</td><td>1, 3, 5, 11 to 16</td><td>outdoor air temperature is higher than the return air temperature (<code>TCut=TRet</code>)</td>
</tr>
<tr>
<td>2, 4, 10</td><td>outdoor air temperature is higher than the return air temperature minus 1 °C (<code>TCut=TRet-1°C</code>)</td>
</tr>
<tr>
<td>6, 8, 9</td><td>outdoor air temperature is higher than the return air temperature minus 2 °C (<code>TCut=TRet-2°C</code>)</td>
</tr>
<tr>
<td>7</td><td>outdoor air temperature is higher than the return air temperature minus 3 °C (<code>TCut=TRet-3°C</code>)</td>
</tr>
<tr>
<td>Fixed enthalpy with fixed dry bulb</td><td>All</td>
<td>outdoor air temperature is higher than 24 °C or the enthalpy is higher than 66 kJ/kg (<code>TCut=24°C</code> or <code>hCut=66kJ/kg</code>)</td>
</tr>
<tr>
<td rowspan="\&quot;4\&quot;">Fixed dry bulb with differential dry bulb</td><td>1, 3, 5, 11 to 16</td>
<td>outdoor air temperature is higher than 24 °C or the return air temperature (<code>TCut=24°C</code> or <code>TCut=TRet</code>)</td>
</tr>
<tr>
<td>2, 4, 10</td>
<td>outdoor air temperature is higher than 23 °C or the return air temperature minus 1 °C (<code>TCut=min(23°C, TRet-1°C)</code>)</td>
</tr>
<tr>
<td>6, 8, 9</td>
<td>outdoor air temperature is higher than 22 °C or the return air temperature minus 2 °C (<code>TCut=min(22°C, TRet-2°C)</code>)</td>
</tr>
<tr>
<td>7</td>
<td>outdoor air temperature is higher than 21 °C or the return air temperature minus 3 °C (<code>TCut=min(21°C, TRet-3°C)</code>)</td>
</tr>
</tbody></table>
<br>
<p>
Note that the device type <i>Fixed dry bulb with differential dry bulb</i> is not listed in either ASHRAE 90.1 or Title 24 standard.
But it is possible to use in practice. See Section 3.1.6.2 in Guideline 36.
</p><h1><a name="10multi-zone-vav-ahu-economize"></a><!--[if !supportLists]--><span style="mso-list:Ignore">10.&nbsp;</span><!--[endif]-->Multi zone VAV AHU economizer control sequence</h1>
<p>
Multi zone VAV AHU economizer control sequence that calculates
outdoor and return air damper positions based on ASHRAE
Guidline 36, May 2020, Sections: 5.16.2.3,5.16.4, 5.16.5, 5.16.6, 5.16.7.
</p>
<p>
The sequence consists of three sets of subsequences.
</p>
<ul>
<li>
First set of sequences compute the damper position limits to satisfy
outdoor air requirements. Different sequence will be enabled depending on the
designes minimum outdoor air and economizer function, which include
<ol type="\&quot;i\&quot;">
<li>
separate minimum outdoor air damper, with airflow measurement. 
See
<a href="#3outdoor-air-and-return-air-da" style="white-space: nowrap;">Section 3</a>
for a description.
</li>
<li>
separate minimum outdoor air damper, with differential pressure measurement. 
See
<a href="#4outdoor-air-and-return-air-da" style="white-space: nowrap;">Section 4</a>
for a description.
</li>
<li>
single common minimum outdoor air and economizer damper. 
See
<a href="#5outdoor-air-and-return-air-da" style="white-space: nowrap;">Section 5</a>
for a description.
</li>
</ol>
</li>

<li>
The second set of sequences which have one sequence enable or disable the economizer based on
outdoor temperature and optionally enthalpy, and based on the supply fan status,
freeze protection stage and zone state.
See
<a href="#6multi-zone-vav-ahu-economizer" style="white-space: nowrap;">Section 6</a>
for a description.
</li>

<li>
Third set of sequences modulate the outdoor and return damper position
to track the supply air temperature setpoint, subject to the limits of the damper positions
that were computed in the above blocks. Different sequence will be enabled depending
on the types of building pressure control system, which include
<ol type="\&quot;i\&quot;">
<li>
relief damper or relief fan control. 
See
<a href="#8modulates-dampers-of-economiz" style="white-space: nowrap;">Section 8</a>
for a description.
</li>
<li>
return fan control with airflow tracking, or with direct building pressure control. 
See
<a href="#7modulates-dampers-of-economiz" style="white-space: nowrap;">Section 7</a>
for a description.
</li>
</ol>
</li>
</ul><h1><a name="11block-to-inplement-trim-and-"></a><!--[if !supportLists]--><span style="mso-list:Ignore">11.&nbsp;</span><!--[endif]-->Block to inplement trim and respond logic</h1>
<p>
This block implements the trim and respond logic according to Section 5.1.14.3 
and 5.1.14.4 of ASHRAE Guideline 36, May 2020.
</p>
<p>
For each upstream system or plant set point being controlled by a trim and respond
loop, define the initial values in system or plant sequences. Values for trim,
respond, time step, etc. shall be tuned to provide stable control.
</p>
<table summary="\&quot;summary\&quot;" border="\&quot;1\&quot;">
<tbody><tr><th> Variable </th> <th> Value </th> <th> Definition </th> </tr>
<tr><td>Device</td><td>AHU Supply Fan</td> <td>Associated device</td></tr>
<tr><td>SP0</td><td><code>iniSet</code>&nbsp;(120, adjustable)</td><td>Initial setpoint</td></tr>
<tr><td>SPmin</td><td><code>minSet</code>&nbsp;(25, adjustable)</td><td>Minimum setpoint</td></tr>
<tr><td>SPmax</td><td><code>maxSet</code>&nbsp;(1000, adjustable)</td><td>Maximum setpoint</td></tr>
<tr><td>Td</td><td><code>delTim</code>&nbsp;(600&nbsp;s, adjustable)</td><td>Delay timer</td></tr>
<tr><td>T</td><td><code>samplePeriod</code>&nbsp;(120&nbsp;s, adjustable)</td><td>Time step</td></tr>
<tr><td>I</td><td><code>numIgnReq</code>&nbsp;(2, adjustable)</td><td>Number of ignored requests</td></tr>
<tr><td>R</td><td><code>numOfReq</code></td><td>Number of requests</td></tr>
<tr><td>SPtrim</td><td><code>triAmo</code>&nbsp;(-12, adjustable)</td><td>Trim amount</td></tr>
<tr><td>SPres</td><td><code>resAmo</code>&nbsp;(15, adjustable)</td><td>Respond amount</td></tr>
<tr><td>SPres_max</td><td><code>maxRes</code>&nbsp;(32, adjustable)</td><td>Maximum response per time interval</td></tr>
</tbody></table>
<p>
The trim and respond logic shall reset setpoint within the range <code>minSet</code>&nbsp;(25, adjustable) to
<code>maxSet</code>&nbsp;(1000, adjustable).
When the associated device is off (<code>uDevSta=false</code>), the setpoint
shall be <code>iniSet</code>&nbsp;(120, adjustable).
The reset logic shall be active while the associated device is proven
on (<code>uDevSta=true</code>), starting <code>delTim</code>&nbsp;(600&nbsp;s, adjustable) after initial
device start command.
When active, every time step <code>samplePeriod</code>&nbsp;(120&nbsp;s, adjustable), trim the setpoint by
<code>triAmo</code>&nbsp;(-12, adjustable).
If there are more than <code>numIgnReq</code>&nbsp;(2, adjustable) requests, respond by changing
the setpoint by <code>resAmo*(numOfReq-numIgnReq)</code>, i.e., the number of
requests minus the number of ignored requests, but no more than <code>maxRes</code>&nbsp;(32, adjustable).
</p>
<p>
In other words, every time step <code>samplePeriod</code>&nbsp;(120&nbsp;s, adjustable):
</p>
<ul>
<li>Change setpoint by <code>triAmo</code>&nbsp;(-12, adjustable); </li>
<li>If <code>numOfReq &gt; numIgnReq</code>, <i>also</i> change setpoint by <code>resAmo*(numOfReq
-numIgnReq)</code> but no more than <code>maxRes</code>&nbsp;(32, adjustable).
</li>
</ul>
<h2><a name="11.1hold-and-release-loop-outp"></a><!--[if !supportLists]--><span style="mso-list:Ignore">11.1.&nbsp;</span><!--[endif]-->Hold and release loop output</h2>

<p>
Optionally, if the parameter <code>have_hol</code> is set to true, an additional
input signal <code>uHol</code> allows for holding the trim and respond loop output
at a fixed value for the longer of the time the input <code>uHol</code> remains true 
and the duration specified by the parameter <code>dtHol</code>&nbsp;(0&nbsp;s, adjustable).
When <code>uHol</code> switches back to false, the hold is released and resetting
continues from the previously held value (without reinitializing to <code>iniSet</code>&nbsp;(120, adjustable)
or going through a delay time of <code>delTim</code>&nbsp;(600&nbsp;s, adjustable)). 
</p>
<p>
This is typically used in control sequences to freeze the reset logic during the plant
staging process.
Consider for example the following specification:<br>
\"When a plant stage change is initiated, the reset logic shall be disabled and value
fixed at its last value for the longer of <i>15</i> minutes and the time it takes 
for the plant to successfully stage.\"<br>
Using this block with <code>have_hol=true</code> and <code>dtHol=15*60</code> 
yields the following sequence of events.
</p>
<ul>
<li>0:00 - Stage change is initiated. T&amp;R loop output is at <i>50&nbsp;%</i>.</li>
<li>0:12 - Stage change is completed. T&amp;R loop output remains at <i>50&nbsp;%</i> 
since <i>&lt;&nbsp;15&nbsp;</i>minutes have elapsed.</li>
<li>0:15 - T&amp;R is released and continues resetting from <i>50&nbsp;%</i>.</li>
</ul>
<h2><a name="11.2examples"></a><!--[if !supportLists]--><span style="mso-list:Ignore">11.2.&nbsp;</span><!--[endif]-->Examples</h2>

<p>
The figure below illustrates the trim and respond logic with a negative trim amount,
comparing scenarios with and without holding the loop output.
</p>
<p>
<img alt="\&quot;Trend" graph="" for="" trim="" and="" response\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_Generic_TrimAndRespond.png">
</p>
<p>
The figure below illustrates the trim and respond logic with a positive trim amount.
</p>
<p>
<img alt="\&quot;Trend" graph="" for="" trim="" and="" response\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_Generic_TrimAndRespond1.png">
</p>
<p>
The figure below illustrates the trim and respond logic with a negative trim amount,
in a scenario where the equipment switches on and off.
</p>
<p>
<img alt="\&quot;Trend" graph="" for="" trim="" and="" response\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_Generic_TrimAndRespond2.png">
</p><h1><a name="12block-to-control-multi-zone-"></a><!--[if !supportLists]--><span style="mso-list:Ignore">12.&nbsp;</span><!--[endif]-->Block to control multi zone VAV AHU supply fan</h1>
<p>
Supply fan control for a multi zone VAV AHU according to Section 5.16.1 of 
ASHRAE Guideline G36, May 2020.
</p>
<h2><a name="12.1supply-fan-start/stop"></a><!--[if !supportLists]--><span style="mso-list:Ignore">12.1.&nbsp;</span><!--[endif]-->Supply fan start/stop</h2>

<ul>
<li>Supply fan shall run when system is in the Cool-down, Setup, or Occupied mode</li>
<li>If there are any VAV-reheat boxes on perimeter zones, supply fan shall also
run when system is in Setback or Warmup mode</li>
</ul>
<h2><a name="12.2static-pressure-setpoint-r"></a><!--[if !supportLists]--><span style="mso-list:Ignore">12.2.&nbsp;</span><!--[endif]-->Static pressure setpoint reset</h2>

<p>
Static pressure setpoint shall be reset using trim-respond logic using following
parameters as a starting point:
</p>
<table summary="\&quot;summary\&quot;" border="\&quot;1\&quot;">
<tbody><tr><th> Variable </th> <th> Value </th> <th> Definition </th> </tr>
<tr><td>Device</td><td>AHU Supply Fan</td> <td>Associated device</td></tr>
<tr><td>SP0</td><td><code>iniSet</code>&nbsp;(120&nbsp;Pa, adjustable)</td><td>Initial setpoint</td></tr>
<tr><td>SPmin</td><td><code>minSet</code>&nbsp;(25&nbsp;Pa, adjustable)</td><td>Minimum setpoint</td></tr>
<tr><td>SPmax</td><td><code>maxSet</code>&nbsp;(1000&nbsp;Pa, adjustable)</td><td>Maximum setpoint</td></tr>
<tr><td>Td</td><td><code>delTim</code>&nbsp;(600&nbsp;s, adjustable)</td><td>Delay timer</td></tr>
<tr><td>T</td><td><code>samplePeriod</code>&nbsp;(120&nbsp;s, adjustable)</td><td>Time step</td></tr>
<tr><td>I</td><td><code>numIgnReq</code>&nbsp;(2, adjustable)</td><td>Number of ignored requests</td></tr>
<tr><td>R</td><td><code>uZonPreResReq</code></td><td>Number of requests</td></tr>
<tr><td>SPtrim</td><td><code>triAmo</code>&nbsp;(-12&nbsp;Pa, adjustable)</td><td>Trim amount</td></tr>
<tr><td>SPres</td><td><code>resAmo</code>&nbsp;(15&nbsp;Pa, adjustable)</td><td>Respond amount</td></tr>
<tr><td>SPres_max</td><td><code>maxRes</code>&nbsp;(32&nbsp;Pa, adjustable)</td><td>Maximum response per time interval</td></tr>
</tbody></table>
<br>
<h2><a name="12.3static-pressure-control"></a><!--[if !supportLists]--><span style="mso-list:Ignore">12.3.&nbsp;</span><!--[endif]-->Static pressure control</h2>

<p>
Supply fan speed is controlled with a PI controller to maintain duct static pressure at setpoint
when the fan is proven on. The setpoint for the PI controller and the measured
duct static pressure are normalized with the maximum design static presssure
<code>maxSet</code>&nbsp;(1000&nbsp;Pa, adjustable).
Where the zone groups served by the system are small,
provide multiple sets of gains that are used in the control loop as a function
of a load indicator (such as supply fan airflow rate, the area of the zone groups
that are occupied, etc.).
</p><h1><a name="13multizone-vav-ahu-supply-air"></a><!--[if !supportLists]--><span style="mso-list:Ignore">13.&nbsp;</span><!--[endif]-->Multizone VAV AHU supply air temperature control loop and coil valves position</h1>
<p>
Block that outputs the supply temperature control loop signal,
and the coil valve postions for VAV system with multiple zones,
implemented according to Section 5.16.2.3 of the ASHRAE Guideline G36, May 2020.
</p>
<p>
The supply air temperature control loop signal <code>uTSup</code>
is computed using a PI controller that tracks the supply air temperature
setpoint <code>TSupSet</code>.
If the fan is off, then <code>uTSup = 0</code>.
</p>
<p>
Heating valve control signal (or modulating electric heating
coil if applicable) <code>yHeaCoi</code> and cooling valve control signal <code>yCooCoi</code>
are sequenced based on the supply air temperature control loop signal <code>uTSup</code>.
From <code>uTSup = uHea_max</code> to <code>uTSup = -1</code>,
<code>yHeaCoi</code> increases linearly from <i>0</i> to <i>1</i>.
Similarly, <code>uTSup = uCoo_min</code> to <code>uTSup = +1</code>,
<code>yCooCoi</code> increases linearly from <i>0</i> to <i>1</i>.
</p>

<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" supply="" temperature="" loop\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_SetPoints_SupTemLoop.png">
</p>

<p>
The output <code>uTSup</code> can be used in a controller for the economizer.
</p><h1><a name="14block-to-inplement-trim-and-"></a><!--[if !supportLists]--><span style="mso-list:Ignore">14.&nbsp;</span><!--[endif]-->Block to inplement trim and respond logic</h1>
<p>
This block implements the trim and respond logic according to Section 5.1.14.3 
and 5.1.14.4 of ASHRAE Guideline 36, May 2020.
</p>
<p>
For each upstream system or plant set point being controlled by a trim and respond
loop, define the initial values in system or plant sequences. Values for trim,
respond, time step, etc. shall be tuned to provide stable control.
</p>
<table summary="\&quot;summary\&quot;" border="\&quot;1\&quot;">
<tbody><tr><th> Variable </th> <th> Value </th> <th> Definition </th> </tr>
<tr><td>Device</td><td>AHU Supply Fan</td> <td>Associated device</td></tr>
<tr><td>SP0</td><td><code>iniSet</code>&nbsp;(291.15, adjustable)</td><td>Initial setpoint</td></tr>
<tr><td>SPmin</td><td><code>minSet</code>&nbsp;(285.15, adjustable)</td><td>Minimum setpoint</td></tr>
<tr><td>SPmax</td><td><code>maxSet</code>&nbsp;(291.15, adjustable)</td><td>Maximum setpoint</td></tr>
<tr><td>Td</td><td><code>delTim</code>&nbsp;(600&nbsp;s, adjustable)</td><td>Delay timer</td></tr>
<tr><td>T</td><td><code>samplePeriod</code>&nbsp;(120&nbsp;s, adjustable)</td><td>Time step</td></tr>
<tr><td>I</td><td><code>numIgnReq</code>&nbsp;(2, adjustable)</td><td>Number of ignored requests</td></tr>
<tr><td>R</td><td><code>numOfReq</code></td><td>Number of requests</td></tr>
<tr><td>SPtrim</td><td><code>triAmo</code>&nbsp;(0.1, adjustable)</td><td>Trim amount</td></tr>
<tr><td>SPres</td><td><code>resAmo</code>&nbsp;(-0.2, adjustable)</td><td>Respond amount</td></tr>
<tr><td>SPres_max</td><td><code>maxRes</code>&nbsp;(-0.6, adjustable)</td><td>Maximum response per time interval</td></tr>
</tbody></table>
<p>
The trim and respond logic shall reset setpoint within the range <code>minSet</code>&nbsp;(285.15, adjustable) to
<code>maxSet</code>&nbsp;(291.15, adjustable).
When the associated device is off (<code>uDevSta=false</code>), the setpoint
shall be <code>iniSet</code>&nbsp;(291.15, adjustable).
The reset logic shall be active while the associated device is proven
on (<code>uDevSta=true</code>), starting <code>delTim</code>&nbsp;(600&nbsp;s, adjustable) after initial
device start command.
When active, every time step <code>samplePeriod</code>&nbsp;(120&nbsp;s, adjustable), trim the setpoint by
<code>triAmo</code>&nbsp;(0.1, adjustable).
If there are more than <code>numIgnReq</code>&nbsp;(2, adjustable) requests, respond by changing
the setpoint by <code>resAmo*(numOfReq-numIgnReq)</code>, i.e., the number of
requests minus the number of ignored requests, but no more than <code>maxRes</code>&nbsp;(-0.6, adjustable).
</p>
<p>
In other words, every time step <code>samplePeriod</code>&nbsp;(120&nbsp;s, adjustable):
</p>
<ul>
<li>Change setpoint by <code>triAmo</code>&nbsp;(0.1, adjustable); </li>
<li>If <code>numOfReq &gt; numIgnReq</code>, <i>also</i> change setpoint by <code>resAmo*(numOfReq
-numIgnReq)</code> but no more than <code>maxRes</code>&nbsp;(-0.6, adjustable).
</li>
</ul>
<h2><a name="14.1hold-and-release-loop-outp"></a><!--[if !supportLists]--><span style="mso-list:Ignore">14.1.&nbsp;</span><!--[endif]-->Hold and release loop output</h2>

<p>
Optionally, if the parameter <code>have_hol</code> is set to true, an additional
input signal <code>uHol</code> allows for holding the trim and respond loop output
at a fixed value for the longer of the time the input <code>uHol</code> remains true 
and the duration specified by the parameter <code>dtHol</code>&nbsp;(0&nbsp;s, adjustable).
When <code>uHol</code> switches back to false, the hold is released and resetting
continues from the previously held value (without reinitializing to <code>iniSet</code>&nbsp;(291.15, adjustable)
or going through a delay time of <code>delTim</code>&nbsp;(600&nbsp;s, adjustable)). 
</p>
<p>
This is typically used in control sequences to freeze the reset logic during the plant
staging process.
Consider for example the following specification:<br>
\"When a plant stage change is initiated, the reset logic shall be disabled and value
fixed at its last value for the longer of <i>15</i> minutes and the time it takes 
for the plant to successfully stage.\"<br>
Using this block with <code>have_hol=true</code> and <code>dtHol=15*60</code> 
yields the following sequence of events.
</p>
<ul>
<li>0:00 - Stage change is initiated. T&amp;R loop output is at <i>50&nbsp;%</i>.</li>
<li>0:12 - Stage change is completed. T&amp;R loop output remains at <i>50&nbsp;%</i> 
since <i>&lt;&nbsp;15&nbsp;</i>minutes have elapsed.</li>
<li>0:15 - T&amp;R is released and continues resetting from <i>50&nbsp;%</i>.</li>
</ul>
<h2><a name="14.2examples"></a><!--[if !supportLists]--><span style="mso-list:Ignore">14.2.&nbsp;</span><!--[endif]-->Examples</h2>

<p>
The figure below illustrates the trim and respond logic with a negative trim amount,
comparing scenarios with and without holding the loop output.
</p>
<p>
<img alt="\&quot;Trend" graph="" for="" trim="" and="" response\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_Generic_TrimAndRespond.png">
</p>
<p>
The figure below illustrates the trim and respond logic with a positive trim amount.
</p>
<p>
<img alt="\&quot;Trend" graph="" for="" trim="" and="" response\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_Generic_TrimAndRespond1.png">
</p>
<p>
The figure below illustrates the trim and respond logic with a negative trim amount,
in a scenario where the equipment switches on and off.
</p>
<p>
<img alt="\&quot;Trend" graph="" for="" trim="" and="" response\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_Generic_TrimAndRespond2.png">
</p><h1><a name="15supply-air-temperature-setpo"></a><!--[if !supportLists]--><span style="mso-list:Ignore">15.&nbsp;</span><!--[endif]-->Supply air temperature setpoint for multi zone system</h1>
<p>
Block that outputs the supply air temperature setpoint and the coil valve control
inputs for VAV system with multiple zones, implemented according to Section 5.16.2 of
the ASHRAE Guideline G36, May 2020.
</p>
<p>
The control loop is enabled when the supply air fan <code>u1SupFan</code> is proven on,
and disabled and the output set to deadband (no heating, minimum economizer) otherwise.
</p>
<p> The supply air temperature setpoint is computed as follows.</p>

<h2><a name="15.1setpoints-for-tsupcoo_min,"></a><!--[if !supportLists]--><span style="mso-list:Ignore">15.1.&nbsp;</span><!--[endif]-->Setpoints for TSupCoo_min, TSupCoo_max,
TOut_min, TOut_max
</h2>

<p>
Per Section 3.1.4.1, the setpoints are design information.
</p>
<ul>
<li>
The <code>TSupCoo_min</code>&nbsp;(12&nbsp;°C, adjustable) should be set no lower than the design coil leaving air
temperature to prevent excessive chilled water temperature reset requests.
</li>
<li>
The <code>TSupCoo_max</code>&nbsp;(18&nbsp;°C, adjustable) is typically 18 °C (65 °F) in mild and dry climates
and 16 °C (60 °F) or lower in humid climates. It should not typically be
greater than 18 °C (65 °F).
</li>
<li>
The default range of outdoor air temperature (<code>TOut_min=16°C</code>,
<code>TOut_max=21°C</code>) used to reset the occupied mode <code>TSupSet</code>
was chosen to maximize economizer hours. It may be preferable to use a lower
range of outdoor air temperature (e.g. <code>TOut_min=13°C</code>,
<code>TOut_max=18°C</code>) to minimize fan energy.
</li>
</ul>

<h2><a name="15.2during-occupied-and-setup-"></a><!--[if !supportLists]--><span style="mso-list:Ignore">15.2.&nbsp;</span><!--[endif]-->During occupied and Setup modes (uOpeMod=1, uOpeMod=2)</h2>

<p>
The <code>TSupSet</code> shall be reset from <code>TSupCoo_min</code>&nbsp;(12&nbsp;°C, adjustable) when the outdoor
air temperature is <code>TOut_max</code>&nbsp;(21&nbsp;°C, adjustable) and above, proportionally up to
maximum supply temperature when the outdoor air temperature is <code>TOut_min</code>&nbsp;(16&nbsp;°C, adjustable) and
below. The maximum supply temperature shall be reset using trim and respond logic between
<code>TSupCoo_min</code>&nbsp;(12&nbsp;°C, adjustable) and <code>TSupCoo_max</code>&nbsp;(18&nbsp;°C, adjustable). Parameters suggested for the
trim and respond logic are shown in the table below. They require adjustment
during the commissioning and tuning phase.
</p>

<table summary="\&quot;summary\&quot;" border="\&quot;1\&quot;">
<tbody><tr><th> Variable </th> <th> Value </th> <th> Definition </th> </tr>
<tr><td>Device</td><td>AHU Supply Fan</td> <td>Associated device</td></tr>
<tr><td>SP0</td><td><code>iniSet</code>&nbsp;(18&nbsp;°C, adjustable)</td><td>Initial setpoint</td></tr>
<tr><td>SPmin</td><td><code>TSupCoo_min</code>&nbsp;(12&nbsp;°C, adjustable)</td><td>Minimum setpoint</td></tr>
<tr><td>SPmax</td><td><code>TSupCoo_max</code>&nbsp;(18&nbsp;°C, adjustable)</td><td>Maximum setpoint</td></tr>
<tr><td>Td</td><td><code>delTim</code>&nbsp;(600&nbsp;s, adjustable)</td><td>Delay timer</td></tr>
<tr><td>T</td><td><code>samplePeriod</code>&nbsp;(120&nbsp;s, adjustable)</td><td>Time step</td></tr>
<tr><td>I</td><td><code>numIgnReq</code>&nbsp;(2, adjustable)</td><td>Number of ignored requests</td></tr>
<tr><td>R</td><td><code>uZonTemResReq</code></td><td>Number of requests</td></tr>
<tr><td>SPtrim</td><td><code>triAmo</code>&nbsp;(0.1&nbsp;K, adjustable)</td><td>Trim amount</td></tr>
<tr><td>SPres</td><td><code>resAmo</code>&nbsp;(-0.2&nbsp;K, adjustable)</td><td>Respond amount</td></tr>
<tr><td>SPres_max</td><td><code>maxRes</code>&nbsp;(-0.6&nbsp;K, adjustable)</td><td>Maximum response per time interval</td></tr>
</tbody></table>
<br>

<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" set="" point="" reset\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_SetPoints_VAVSupTempSet.png">
</p>

<h2><a name="15.3during-cool-down-modes-(uo"></a><!--[if !supportLists]--><span style="mso-list:Ignore">15.3.&nbsp;</span><!--[endif]-->During Cool-down modes (uOpeMod=3)</h2>

<p>
Supply air temperature setpoint <code>TSupSet</code> shall be <code>TSupCoo_min</code>&nbsp;(12&nbsp;°C, adjustable).
</p>
<h2><a name="15.4during-setback-and-warmup-"></a><!--[if !supportLists]--><span style="mso-list:Ignore">15.4.&nbsp;</span><!--[endif]-->During Setback and Warmup modes (uOpeMod=4, uOpeMod=5)</h2>

<p>
Supply air temperature setpoint <code>TSupSet</code> shall be <code>TSupWarUpSetBac</code>&nbsp;(35&nbsp;°C, adjustable).
</p><h1><a name="16outdoor-airflow-related-calc"></a><!--[if !supportLists]--><span style="mso-list:Ignore">16.&nbsp;</span><!--[endif]-->Outdoor airflow related calculations at the AHU level</h1>
<p>
This sequence outputs AHU level uncorrected minimum outdoor airflow rate
<code>VUncOutAir_flow</code> and effective minimum outdoor airflow rate
<code>VEffOutAir_flow</code> when complying with ASHRAE Standard 62.1 ventilation requirements.
It is implemented according to Section 5.16.3.1 of ASHRAE
Guideline G36, May 2020.
</p>
<p>
It requires following inputs which are sum or maximum of the outputs from
the zone level calculation. See
<span style="color: grey;" id="Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.SetPoints.OutdoorAirFlow.ASHRAE62_1.SumZone"><a>
Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.SetPoints.OutdoorAirFlow.ASHRAE62_1.SumZone</a></span>
for these inputs.
</p>
<ol>
<li>
Sum of the adjusted population component breathing zone flow rate for all zones that are in
all zone groups in occupied mode, <code>VSumAdjPopBreZon_flow</code>.
</li>
<li>
Sum of the adjusted area component breathing zone flow rate for all zones that are in
all zone groups in occupied mode, <code>VSumAdjAreBreZon_flow</code>.
</li>
<li>
Sum of the zone primary airflow rates for all zones in all zone groups that are
in occupied mode,<code>VSumZonPri_flow</code>.
</li>
<li>
Maximum zone outdoor air fraction for all zones in all zone groups that are
in occupied mode, <code>uOutAirFra_max</code>.
</li>
</ol>
<p>
The calculation is done using the steps below.
</p>
<ol>
<li>
See Section 3.1.4.2.a of Guideline 36 for setpoints <code>VUncDesOutAir_flow</code>&nbsp;(0&nbsp;m3/s, adjustable)
and <code>VDesTotOutAir_flow</code>&nbsp;(0&nbsp;m3/s, adjustable).
</li>
<li>
The uncorrected outdoor airflow rate setpoint <code>VUncOutAir_flow</code> is recalculated
continuously based on the adjusted population and area component breathing zone flow rate
of the zones being served determined in accordance with Section 5.2.1.3. See
<span style="color: grey;" id="Buildings.Controls.OBC.ASHRAE.G36.VentilationZones.ASHRAE62_1.Setpoints"><a>
Buildings.Controls.OBC.ASHRAE.G36.VentilationZones.ASHRAE62_1.Setpoints</a></span>.
<pre>    VUncOutAir_flow = min(VUncDesOutAir_flow, (VSumAdjPopBreZon_flow + VSumAdjAreBreZon_flow))
</pre>
</li>
<li>
Calculate the current system ventilation efficiency as
<pre>    sysVenEff = 1 + (VUncOutAir_flow/VSumZonPri_flow) - uOutAirFra_max
</pre> 
</li>
<li>
Calculate the effective minimum outdoor air setpoint <code>VEffOutAir_flow</code> as
the uncorrected outdoor air intake divided by the system ventilation efficiency,
but no larger than the design total outdoor airflow rate <code>VDesTotOutAir_flow</code>&nbsp;(0&nbsp;m3/s, adjustable):
<pre>    VEffOutAir_flow = min(VUncOutAir_flow/sysVenEff, VDesTotOutAir_flow)
</pre>
</li>
</ol><h1><a name="17relief-damper-control-for-ah"></a><!--[if !supportLists]--><span style="mso-list:Ignore">17.&nbsp;</span><!--[endif]-->Relief damper control for AHUs using actuated dampers without fan</h1>
<p>
Sequence for controlling actuated relief damper <code>yRelDam</code> for AHUs using
actuated relief damper without a fan.
It is implemented according to Section 5.16.8 of ASHRAE Guideline G36, May 2020.
</p>
<ul>
<li>
Relief dampers shall be enabled when the associated supply fan is proven on
(<code>u1SupFan = true</code>), and disabled otherwise.
</li>
<li>
When enabled, use a P-only control loop to modulate relief dampers to maintain building
static pressure <code>dpBui</code> at its setpoint, which is by defaul
<i>12</i> Pa (<i>0.05</i> inchWC).
</li>
<li>
Close damper when disabled.
</li>
</ul><h1><a name="18return-fan-control-with-dire"></a><!--[if !supportLists]--><span style="mso-list:Ignore">18.&nbsp;</span><!--[endif]-->Return fan control with direct building pressure control</h1>
<p>
Setpoint for return fan discharge pressure and relief air damper
for a multi zone VAV AHU according to Section 5.16.10 of ASHRAE Guideline G36, May 2020.
</p>
<p>
Note that this sequence assumes that the AHU units with return fan having the
return fan with direct building pressure control have the minimum outdoor air damper.
</p>
<ol>
<li>
<p>Return fan operates whenever associated supply fan is proven on and is
off otherwise.</p>
</li>
<li>
<p>Return fan is controlled to maintain return fan discharge static pressure
at setpoint <code>dpBuiSet</code>&nbsp;(12&nbsp;Pa, adjustable).</p>
</li>
<li>
<p>Relief damper is only enabled when the associated supply and return
fans are proven on (<code>u1SupFan=true</code>) and the minimum outdoor air damper is open
(to be controlled in a separate sequence).
The relief dampers is closed when the fan is disabled.</p>
</li>
<li>
<p>The building static pressure is time averaged with a sliding 5-minute window
to dampen fluctuations. The averaged value shall be displayed and is used
for control.</p>
</li>
<li>
<p>When the relief damper is enabled, a control loop modulates the relief damper
in sequence with the return fan static pressure setpoint as shown in the figure
below to maintain the building pressure equal to <code>dpBuiSet</code>&nbsp;(12&nbsp;Pa, adjustable),
which is by default <i>12</i> Pa (<i>0.05</i> inches).
</p>
</li>
</ol>
<p>
The output signal of the building pressure control is as follows:
</p>
<ol>
<li>
From <i>0</i> to <i>0.5</i>, the building pressure control loop modulates the exhaust
dampers from <code>yRelDam = 0</code> (closed) to <code>yRelDam = 1</code> (open).
</li>
<li>
From <i>0.5</i> to <i>1</i>, the building pressure control loop resets the return fan
discharge static pressure setpoint from <code>p_rel_RetFan_min</code>&nbsp;(2.4&nbsp;Pa, adjustable)
to <code>p_rel_RetFan_max</code>&nbsp;(40&nbsp;Pa, adjustable). The <code>p_rel_RetFan_min</code>&nbsp;(2.4&nbsp;Pa, adjustable) and
<code>p_rel_RetFan_max</code>&nbsp;(40&nbsp;Pa, adjustable) are specified in Section 3.2.1.4.
</li>
</ol>
<p align="\&quot;center\&quot;">
<img alt="\&quot;Image" of="" return="" fan="" control="" for="" multi="" zone="" ahu\"="" src="img/Buildings_Resources_Images_Controls_OBC_ASHRAE_G36_AHUs_MultiZone_VAV_SetPoints_ReturnFanControlWithPressure.png">
</p><h1><a name="19return-fan-control-for-ahus-"></a><!--[if !supportLists]--><span style="mso-list:Ignore">19.&nbsp;</span><!--[endif]-->Return fan control for AHUs using return fan with airflow tracking</h1>
<p>
Sequence for controlling return fan <code>yRetFan</code> for AHUs using return fan
with airflow tracking.
It is implemented according to Section 5.16.11 of ASHRAE Guideline G36, May 2020.
</p>
<ul>
<li>
Return fan operates whenever associated supply fan is proven on
(<code>u1SupFan = true</code>).
</li>
<li>
Return fan speed shall be controlled to maintain return airflow equal to supply
airflow less differential <code>difFloSet</code>&nbsp;(0.1&nbsp;m3/s, adjustable), as determined per section 3.2.1.5.
</li>
<li>
Relief or exhaust dampers shall be enabled when the associated supply and return
fans are proven on and closed otherwise. Exhaust dampers shall modulate as the inverse
of the return air damper per section 5.16.2.3. This is implemented in
<a href="#7modulates-dampers-of-economiz" style="white-space: nowrap;">Section 7</a>
</li>
</ul><h1><a name="20ahu-level-setpoint-calculati"></a><!--[if !supportLists]--><span style="mso-list:Ignore">20.&nbsp;</span><!--[endif]-->AHU level setpoint calculation</h1>
<p>
This sequence outputs AHU level effective outdoor air absolute minimum and design
minimum setpoints <code>VEffAbsOutAir_flow</code>, <code>VEffDesOutAir_flow</code> and
the nomalized minimum setpoint <code>effOutAir_normalized</code>
when complying with California Title 24 ventilation requirements.
It is implemented according to Section 5.16.3.2 of ASHRAE
Guideline G36, May 2020.
</p>
<p>
It calculates as below:
</p>
<ol>
<li>
See the sum of zone absolute and design minimum outdoor airflow setpoint
<code>VSumZonAbsMin_flow</code> and <code>VSumZonDesMin_flow</code> from
<span style="color: grey;" id="Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.SetPoints.OutdoorAirFlow.Title24.SumZone"><a>
Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.SetPoints.OutdoorAirFlow.Title24.SumZone</a></span> for the detailed
description.
</li>
<li>
Effective outdoor air absolute minimum and design minimum setpoints
(<code>VEffAbsOutAir_flow</code> and <code>VEffDesOutAir_flow</code>) are recalculated
continuously based on the mode of the zones being served.
<ul>
<li>
Effective outdoor air absolute minimum setpoint <code>VEffAbsOutAir_flow</code> is
the sum of <code>VZonAbsMin_flow</code> for all zones in all zone groups that
are in occupied mode but shall be no larger than the absolute minimum outdoor airflow
<code>VAbsOutAir_flow</code>&nbsp;(0&nbsp;m3/s, adjustable).
</li>
<li>
Effective outdoor air design minimum setpoint <code>VEffDesOutAir_flow</code> is
the sum of <code>VZonDesMin_flow</code> for all zones in all zone groups that
are in occupied mode but shall be no larger than the absolute minimum outdoor airflow
<code>VDesOutAir_flow</code>&nbsp;(0&nbsp;m3/s, adjustable).
</li>
</ul>
</li>
<li>
According to section 5.16.4, 5.16.5 and 5.16.6, the effective minimum outdoor airflow
setpoint should be reset based on the highest zone CO2 control- loop signal from
<code>VEffAbsOutAir_flow</code> at 50% signal to <code>VEffDesOutAir_flow</code>
at 100% signal. When there is no CO2 sensor in any zone, the effective minimum
outdoor airflow setpoint should be equal to the <code>VEffDesOutAir_flow</code>.
</li>
</ol><h1><a name="21sequence-for-control-of-reli"></a><!--[if !supportLists]--><span style="mso-list:Ignore">21.&nbsp;</span><!--[endif]-->Sequence for control of relief fan in AHU</h1>
<p>
Sequence for controling relief fan that is part of AHU. It is developed based on
Section 5.16.9 of ASHRAE Guideline 36, May 2020, with the modification to accommodate
the single relief fan control.
</p>
<ol>
<li>
The relief fan shall be enabled when the AHU supply fan is proven ON
(<code>u1SupFan=true</code>), and shall be disabled otherwise.
</li>
<li>
Building static pressure (<code>dpBui</code>) shall be time averaged with a sliding
5-minute window and 15 second sampling rate (to dampen fluctuations). The average
value shall be that displayed and used for control.
</li>
<li>
A P-only control loop maintains the building pressure at a set point (<code>dpBuiSet</code>&nbsp;(12&nbsp;Pa, adjustable))
of 12 Pa (0.05 in. of water) with an output ranging from 0% to 100%. The loop is disabled
and output set to zero when the relief fan is disabled.
</li>
<li>
Fan speed shall be equal to the PID signal but no less than the minimum speed.
<ol type="\&quot;a\&quot;">
<li>
When relief system is enabled, and the control loop
output is above 5%, open the motorized dampers to the relief fans;
close the dampers when the loop output drops to 0% for 5 minutes.
</li>
<li>
When the control loop output is above minimum speed (<code>relFanSpe_min</code>&nbsp;(0.1, adjustable)) plus 15%
by 7 minutes, start the relief fan.
</li>
<li>
When the control loop output is below minimum speed (<code>relFanSpe_min</code>&nbsp;(0.1, adjustable))
by 5 minutes, shut off the relief fan.
</li>
</ol>
</li>
</ol><h1><a name="22multizone-vav-air-handling-u"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.&nbsp;</span><!--[endif]-->Multizone VAV air handling unit controller</h1>
<p>
Block that is applied for multizone VAV AHU control. It outputs the supply fan status
and the operation speed, outdoor and return air damper position, supply air
temperature setpoint and the valve position of the cooling and heating coils.
It is implemented according to the Section 5.16 of ASHRAE Guideline 36, May 2020.
</p>
<p>
The sequence consists of eight types of subsequences.
</p>
<h2><a name="22.1supply-fan-speed-control"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.1.&nbsp;</span><!--[endif]-->Supply fan speed control</h2>

<p>
The fan speed control is implemented according to Section 5.16.1. It outputs
the boolean signal <code>y1SupFan</code> to turn on or off the supply fan.
In addition, based on the pressure reset request <code>uZonPreResReq</code>
from the VAV zones controller, the
sequence resets the duct pressure setpoint, and uses this setpoint
to modulate the fan speed <code>ySupFanSpe</code> using a PI controller.
See
<a href="#12block-to-control-multi-zone-" style="white-space: nowrap;">Section 12</a>
for more detailed description.
</p>
<h2><a name="22.2minimum-outdoor-airflow-se"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.2.&nbsp;</span><!--[endif]-->Minimum outdoor airflow setting</h2>

<p>
According to current occupany, supply operation status <code>ySupFan</code>,
zone temperatures and the discharge air temperature, the sequence computes the
minimum outdoor airflow rate setpoint, which is used as input for the economizer control.
More detailed information can be found in
<span style="color: grey;" id="Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.SetPoints.OutdoorAirFlow"><a>
Buildings.Controls.OBC.ASHRAE.G36.AHUs.MultiZone.VAV.SetPoints.OutdoorAirFlow</a></span>.
</p>
<h2><a name="22.3economizer-control"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.3.&nbsp;</span><!--[endif]-->Economizer control</h2>

<p>
The block outputs outdoor and return air damper position, <code>yOutDamPos</code> and
<code>yRetDamPos</code>. First, it computes the position limits to satisfy the minimum
outdoor airflow requirement. Second, it determines the availability of the economizer based
on the outdoor condition. The dampers are modulated to track the supply air temperature
loop signal, which is calculated from the sequence below, subject to the minimum outdoor airflow
requirement and economizer availability.
See
<a href="#10multi-zone-vav-ahu-economize" style="white-space: nowrap;">Section 10</a>
for more detailed description.
</p>
<h2><a name="22.4supply-air-temperature-set"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.4.&nbsp;</span><!--[endif]-->Supply air temperature setpoint</h2>

<p>
Based on the Section 5.16.2, the sequence first sets the maximum supply air temperature
based on reset requests collected from each zone <code>uZonTemResReq</code>. The
outdoor temperature <code>TOut</code> and operation mode <code>uOpeMod</code> are used
along with the maximum supply air temperature, for computing the supply air temperature
setpoint. See
<a href="#15supply-air-temperature-setpo" style="white-space: nowrap;">Section 15</a>
for more detailed description.
</p>
<h2><a name="22.5coil-valve-control"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.5.&nbsp;</span><!--[endif]-->Coil valve control</h2>

<p>
The subsequence retrieves supply air temperature setpoint from previous sequence.
Along with the measured supply air temperature and the supply fan status, it
generates coil valve positions. See
<a href="#13multizone-vav-ahu-supply-air" style="white-space: nowrap;">Section 13</a>
for more detailed description.
</p>
<h2><a name="22.6freeze-protection"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.6.&nbsp;</span><!--[endif]-->Freeze protection</h2>

<p>
Based on the Section 5.16.12, the sequence enables freeze protection if the
measured supply air temperature belows certain thresholds. There are three
protection stages. See
<a href="#1freeze-protection-sequence-fo" style="white-space: nowrap;">Section 1</a>
for more detailed description.
</p>
<h2><a name="22.7building-pressure-control"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.7.&nbsp;</span><!--[endif]-->Building pressure control</h2>

<p>
By selecting different building pressure control designs, which includes using actuated
relief damper without fan, using actuated relief dampers with relief fan, using
return fan with direct building pressure control, or using return fan with airflow
tracking control, the sequences controls relief fans, relief dampers and return fans.
See belows sequences for more detailed description:
</p>
<ul>
<li>
<a href="#17relief-damper-control-for-ah" style="white-space: nowrap;">Section 17</a>
</li>
<li> Relief fan control
<a href="#21sequence-for-control-of-reli" style="white-space: nowrap;">Section 21</a> is not
included in the AHU controller. This sequence controls all the relief fans that are
serving one common space, which may include multiple air handling units.
</li>
<li>
<a href="#19return-fan-control-for-ahus-" style="white-space: nowrap;">Section 19</a>
</li>
<li>
<a href="#18return-fan-control-with-dire" style="white-space: nowrap;">Section 18</a>
</li>
</ul>
<h2><a name="22.8plant-request"></a><!--[if !supportLists]--><span style="mso-list:Ignore">22.8.&nbsp;</span><!--[endif]-->Plant request</h2>

<p>
According to the Section 5.16.16, the sequence send out heating or cooling plant requests
if the supply air temperature is below or above threshold value, or the heating or
cooling valves have been widely open for certain times. See
<a href="#2output-plant-requests-for-mul" style="white-space: nowrap;">Section 2</a>
for more detailed description.
</p></body></html>